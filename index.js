const player = "p";
const goal = "g";
const wall = "w";
const bg = 'b'

setLegend(
  [ player, bitmap`
................
................
................
....33333.......
....3....33.....
....3.5..5.3....
....33.....3....
.....33...33....
......3333......
.......3........
.......3........
.....33333......
.......3........
.......33.......
.....33.33......
................`],
  [ goal, bitmap`
................
........000000..
........000000..
..444...000000..
.....4..0..44...
.....4..0..4....
.....4..0.4.....
....4...04......
....4...04......
....44444.......
....44..4.......
................
................
................
................
................`],
  [ wall, bitmap`
C0000000000000C0
0CCCCCCC00000C00
000000CC00000C00
0000CC000000C000
000CCCCC00CC0000
0000000CCC000000
0000000CCC000000
0000000CCC000000
000000CC0C000000
00000CC00C000000
00000C000CCC0000
000CC0000000C000
00CC00000000CC00
0C00000000000C00
C000000000000CC0
0000000000000000`]
  [bg, bitmap`
................
................
................
....0...........
..............0.
................
................
................
.....0..........
................
................
................
................
.........0......
................
................`]
);


setBackground(bg);
setSolids([player, wall]);

onInput("w", () => {
  const playerSprite = getFirst(player);
  if (playerSprite.y > 0 && !tilesWith(wall).includes(getTile(playerSprite.x, playerSprite.y - 1)[0])) {
    playerSprite.y -= 1;
  }
});
onInput("s", () => {
  const playerSprite = getFirst(player);
  if (playerSprite.y < height() - 1 && !tilesWith(wall).includes(getTile(playerSprite.x, playerSprite.y + 1)[0])) {
    playerSprite.y += 1;
  }
});
onInput("a", () => {
  const playerSprite = getFirst(player);
  if (playerSprite.x > 0 && !tilesWith(wall).includes(getTile(playerSprite.x - 1, playerSprite.y)[0])) {
    playerSprite.x -= 1;
  }
});
onInput("d", () => {
  const playerSprite = getFirst(player);
  if (playerSprite.x < width() - 1 && !tilesWith(wall).includes(getTile(playerSprite.x + 1, playerSprite.y)[0])) {
    playerSprite.x += 1;
  }
});

afterInput(() => {
  const playerSprite = getFirst(player);
  const goalSprite = getFirst(goal);
  if (playerSprite.x === goalSprite.x && playerSprite.y === goalSprite.y) {
    addText("You Win!", { x: 5, y: 2, color: color`3` });
  }
});
